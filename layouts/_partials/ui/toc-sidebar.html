{{/* 侧边栏目录组件

显示在页面左侧或右侧的目录
只在大屏幕（≥1280px）且配置为 left/right 模式时显示

@context {page} . 当前文章页面对象
*/}}

{{- $globalTocConfig := .Site.Params.toc | default dict }}
{{- $tocMaxHeight := $globalTocConfig.maxHeight | default "80vh" }}

{{/* frontmatter 参数覆盖 */}}
{{- if isset .Params "toc" }}
{{- if reflect.IsMap .Params.toc }}
{{- if isset .Params.toc "maxHeight" }}
{{- $tocMaxHeight = .Params.toc.maxHeight }}
{{- end }}
{{- end }}
{{- end }}

<!-- 侧边栏目录容器 -->
<div id="toc-sidebar" class="toc-sidebar hidden xl:block w-56 sticky top-24"
  style="max-height: {{ $tocMaxHeight }};" aria-label="{{ i18n `toc.navigation` | default `文章目录导航` }}">

  <!-- 目录标题 -->
  <div class="mb-4 flex items-center gap-2">
    {{ partial "features/icon.html" (dict "name" "list" "size" "sm" "ariaLabel" "") }}
    <h2 class="text-foreground text-sm font-semibold">
      {{ i18n "toc.title" | default "目录" }}
    </h2>
  </div>

  <!-- 目录内容 -->
  <nav id="toc-sidebar-content" class="toc-sidebar-scroll overflow-y-auto pr-2"
    style="max-height: calc({{ $tocMaxHeight }} - 3rem);">
    {{ .TableOfContents }}
  </nav>
</div>