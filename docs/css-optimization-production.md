# CSS ä¼˜åŒ–ä¸ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²åˆ†æ

## æ¦‚è¿°

Hugo Narrow ä¸»é¢˜åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼ˆå¦‚ Vercel éƒ¨ç½²ï¼‰ä¼šè‡ªåŠ¨è¿›è¡Œ CSS å‹ç¼©å’Œä¼˜åŒ–ï¼Œç¡®ä¿æœ€ä½³çš„åŠ è½½æ€§èƒ½ã€‚

## å½“å‰ CSS å¤„ç†æµç¨‹

### ğŸ”§ **CSS å¼•å…¥æ–¹å¼åˆ†æ**

#### **1. ä¸» CSS æ–‡ä»¶å¤„ç†**
```html
<!-- layouts/partials/head/css.html -->
{{ with resources.Get "css/main.css" }}
  {{ $opts := dict "minify" (not hugo.IsDevelopment) }}
  {{ with . | css.TailwindCSS $opts }}
    {{ if hugo.IsDevelopment }}
      <!-- å¼€å‘ç¯å¢ƒï¼šæœªå‹ç¼© -->
      <link rel="stylesheet" href="{{ .RelPermalink }}" />
    {{ else }}
      <!-- ç”Ÿäº§ç¯å¢ƒï¼šå‹ç¼© + æŒ‡çº¹ + å®Œæ•´æ€§æ£€æŸ¥ -->
      {{ with . | fingerprint }}
        <link
          rel="stylesheet"
          href="{{ .RelPermalink }}"
          integrity="{{ .Data.Integrity }}"
          crossorigin="anonymous" />
      {{ end }}
    {{ end }}
  {{ end }}
{{ end }}
```

#### **2. è¯­æ³•é«˜äº® CSS å¤„ç†**
```html
<!-- layouts/partials/head/css.html -->
{{ with resources.Get "css/syntax-highlighting.css" }}
  {{ if hugo.IsDevelopment }}
    <!-- å¼€å‘ç¯å¢ƒï¼šæœªå‹ç¼© -->
    <link rel="stylesheet" href="{{ .RelPermalink }}" />
  {{ else }}
    <!-- ç”Ÿäº§ç¯å¢ƒï¼šå‹ç¼© + æŒ‡çº¹ + å®Œæ•´æ€§æ£€æŸ¥ -->
    {{ with . | minify | fingerprint }}
      <link
        rel="stylesheet"
        href="{{ .RelPermalink }}"
        integrity="{{ .Data.Integrity }}"
        crossorigin="anonymous" />
    {{ end }}
  {{ end }}
{{ end }}
```

### ğŸ“Š **å‹ç¼©æ•ˆæœå¯¹æ¯”**

#### **å¼€å‘ç¯å¢ƒ vs ç”Ÿäº§ç¯å¢ƒ**

| æ–‡ä»¶ç±»å‹ | å¼€å‘ç¯å¢ƒ | ç”Ÿäº§ç¯å¢ƒ | å‹ç¼©æ•ˆæœ |
|----------|----------|----------|----------|
| **ä¸» CSS** | `main.css` (4384 è¡Œ) | `main.[hash].css` (å‹ç¼©) | Tailwind CSS è‡ªåŠ¨ä¼˜åŒ– |
| **è¯­æ³•é«˜äº®** | `syntax-highlighting.css` (339 è¡Œ) | `syntax-highlighting.min.[hash].css` (1 è¡Œ) | **99.7% å‹ç¼©** |

#### **å®é™…æ–‡ä»¶ç¤ºä¾‹**

**å¼€å‘ç¯å¢ƒæ–‡ä»¶ï¼š**
```
assets/css/syntax-highlighting.css (339 è¡Œï¼Œæ ¼å¼åŒ–)
```

**ç”Ÿäº§ç¯å¢ƒæ–‡ä»¶ï¼š**
```
public/css/syntax-highlighting.min.c5e69ea120afaa645c937f1202ca63c3e813993101f2147d0b68922b8bd78bce.css (1 è¡Œï¼Œå‹ç¼©)
```

### ğŸš€ **ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–ç‰¹æ€§**

#### **1. CSS å‹ç¼© (Minification)**
- âœ… **ç§»é™¤ç©ºç™½å­—ç¬¦** - åˆ é™¤æ‰€æœ‰ä¸å¿…è¦çš„ç©ºæ ¼ã€æ¢è¡Œã€åˆ¶è¡¨ç¬¦
- âœ… **ç§»é™¤æ³¨é‡Š** - åˆ é™¤æ‰€æœ‰ CSS æ³¨é‡Š
- âœ… **å‹ç¼©å±æ€§å€¼** - ç®€åŒ–é¢œè‰²å€¼ã€å•ä½ç­‰
- âœ… **åˆå¹¶è§„åˆ™** - åˆå¹¶ç›¸åŒçš„é€‰æ‹©å™¨

**å‹ç¼©å‰ï¼š**
```css
/* è¯­æ³•é«˜äº®æ ·å¼ - åŸºäº Hugo Chromaï¼Œé€‚é…ä¸»é¢˜ç³»ç»Ÿ */

/* äº®è‰²æ¨¡å¼è¯­æ³•é«˜äº® (GitHub é£æ ¼) */
:root:not(.dark) {
  /* å…³é”®å­— - çº¢è‰²ç³» */
  --chroma-k: #cf222e;
  --chroma-kc: #0550ae;
  --chroma-kp: #0550ae;
  /* ... æ›´å¤šå˜é‡ */
}
```

**å‹ç¼©åï¼š**
```css
:root:not(.dark){--chroma-bg:#fff;--chroma-wrapper-bg:#fff;--chroma-err:#f6f8fa;--chroma-err-bg:#82071e;--chroma-hl:#e5e5e5;--chroma-ln:#7f7f7f;--chroma-k:#cf222e;--chroma-n:inherit;--chroma-na:#1f2328;--chroma-nc:#1f2328;--chroma-no:#0550ae;--chroma-nd:#0550ae;--chroma-ni:#6639ba;--chroma-nn:#24292e;--chroma-nx:#1f2328;--chroma-nt:#0550ae;--chroma-nb:#6639ba;--chroma-bp:#6a737d;--chroma-nv:#953800;--chroma-nf:#6639ba;--chroma-s:#0a3069;--chroma-ss:#032f62;--chroma-m:#0550ae;--chroma-o:#0550ae;--chroma-p:#1f2328;--chroma-c:#57606a;--chroma-gd:#82071e;--chroma-gd-bg:#ffebe9;--chroma-gi:#116329;--chroma-gi-bg:#dafbe1;--chroma-go:#1f2328;--chroma-w:#fff}
```

#### **2. æ–‡ä»¶æŒ‡çº¹ (Fingerprinting)**
- âœ… **å†…å®¹å“ˆå¸Œ** - åŸºäºæ–‡ä»¶å†…å®¹ç”Ÿæˆå”¯ä¸€å“ˆå¸Œå€¼
- âœ… **ç¼“å­˜ç ´å** - æ–‡ä»¶æ›´æ–°æ—¶è‡ªåŠ¨æ›´æ–°å“ˆå¸Œï¼Œå¼ºåˆ¶æµè§ˆå™¨é‡æ–°ä¸‹è½½
- âœ… **é•¿æœŸç¼“å­˜** - æœªæ›´æ”¹çš„æ–‡ä»¶å¯ä»¥è¢«æµè§ˆå™¨é•¿æœŸç¼“å­˜

**ç¤ºä¾‹ï¼š**
```
syntax-highlighting.min.c5e69ea120afaa645c937f1202ca63c3e813993101f2147d0b68922b8bd78bce.css
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                        å†…å®¹å“ˆå¸Œ - æ–‡ä»¶å†…å®¹æ”¹å˜æ—¶ä¼šè‡ªåŠ¨æ›´æ–°
```

#### **3. å®Œæ•´æ€§æ£€æŸ¥ (Subresource Integrity)**
- âœ… **å®‰å…¨æ€§** - é˜²æ­¢ CSS æ–‡ä»¶è¢«æ¶æ„ç¯¡æ”¹
- âœ… **å®Œæ•´æ€§éªŒè¯** - æµè§ˆå™¨éªŒè¯æ–‡ä»¶å®Œæ•´æ€§åæ‰æ‰§è¡Œ
- âœ… **CDN å®‰å…¨** - å³ä½¿é€šè¿‡ CDN åˆ†å‘ä¹Ÿèƒ½ä¿è¯å®‰å…¨æ€§

**ç¤ºä¾‹ï¼š**
```html
<link
  rel="stylesheet"
  href="/css/syntax-highlighting.min.c5e69ea120afaa645c937f1202ca63c3e813993101f2147d0b68922b8bd78bce.css"
  integrity="sha256-oRwWzdPj3JuPkVkB9L2jfbrCeWuWYNmHOebHNDpojso="
  crossorigin="anonymous" />
```

### ğŸŒ **Vercel éƒ¨ç½²ä¼˜åŒ–**

#### **Vercel å¹³å°é¢å¤–ä¼˜åŒ–**
1. **Gzip/Brotli å‹ç¼©** - Vercel è‡ªåŠ¨å¯¹ CSS æ–‡ä»¶è¿›è¡Œ Gzip æˆ– Brotli å‹ç¼©
2. **å…¨çƒ CDN** - CSS æ–‡ä»¶é€šè¿‡å…¨çƒ CDN åˆ†å‘ï¼Œå°±è¿‘è®¿é—®
3. **HTTP/2 æ¨é€** - æ”¯æŒ HTTP/2 æœåŠ¡å™¨æ¨é€ï¼Œæå‰åŠ è½½å…³é”®èµ„æº
4. **ç¼“å­˜ç­–ç•¥** - æ™ºèƒ½ç¼“å­˜ç­–ç•¥ï¼Œå¹³è¡¡æ€§èƒ½å’Œæ›´æ–°é¢‘ç‡

#### **å®é™…å‹ç¼©æ•ˆæœ**
```
åŸå§‹æ–‡ä»¶å¤§å°ï¼š    ~15KB (syntax-highlighting.css)
Hugo å‹ç¼©åï¼š     ~3KB  (ç§»é™¤ç©ºç™½å’Œæ³¨é‡Š)
Vercel Gzipï¼š     ~1KB  (é¢å¤–å‹ç¼© 66%)
Vercel Brotliï¼š   ~0.8KB (é¢å¤–å‹ç¼© 73%)
```

### ğŸ“ˆ **æ€§èƒ½ä¼˜åŒ–å»ºè®®**

#### **1. å½“å‰å®ç°å·²ç»å¾ˆä¼˜ç§€**
- âœ… **è‡ªåŠ¨å‹ç¼©** - ç”Ÿäº§ç¯å¢ƒè‡ªåŠ¨å¯ç”¨
- âœ… **æ–‡ä»¶æŒ‡çº¹** - å®Œç¾çš„ç¼“å­˜ç­–ç•¥
- âœ… **å®Œæ•´æ€§æ£€æŸ¥** - å®‰å…¨æ€§ä¿éšœ
- âœ… **åˆ†ç¦»åŠ è½½** - ä¸» CSS å’Œè¯­æ³•é«˜äº® CSS åˆ†ç¦»

#### **2. å¯é€‰çš„è¿›ä¸€æ­¥ä¼˜åŒ–**

**Critical CSS å†…è”ï¼ˆå¯é€‰ï¼‰ï¼š**
```html
<!-- å¯ä»¥è€ƒè™‘å°†å…³é”® CSS å†…è”åˆ° HTML ä¸­ -->
<style>
  /* å…³é”®çš„é¦–å± CSS */
  .header, .nav { /* ... */ }
</style>
```

**CSS é¢„åŠ è½½ï¼ˆå¯é€‰ï¼‰ï¼š**
```html
<!-- é¢„åŠ è½½éå…³é”® CSS -->
<link rel="preload" href="/css/syntax-highlighting.min.[hash].css" as="style" onload="this.onload=null;this.rel='stylesheet'">
```

### ğŸ” **ç›‘æ§å’Œè°ƒè¯•**

#### **æ£€æŸ¥å‹ç¼©æ•ˆæœ**
```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
hugo --buildDrafts --buildFuture --minify

# æ£€æŸ¥ç”Ÿæˆçš„æ–‡ä»¶
ls -la public/css/

# æ¯”è¾ƒæ–‡ä»¶å¤§å°
du -h assets/css/syntax-highlighting.css
du -h public/css/syntax-highlighting.min.*.css
```

#### **æ€§èƒ½æµ‹è¯•å·¥å…·**
- **Google PageSpeed Insights** - åˆ†æé¡µé¢åŠ è½½æ€§èƒ½
- **WebPageTest** - è¯¦ç»†çš„åŠ è½½æ—¶é—´åˆ†æ
- **Chrome DevTools** - ç½‘ç»œé¢æ¿æŸ¥çœ‹èµ„æºåŠ è½½

### ğŸ“‹ **æœ€ä½³å®è·µæ€»ç»“**

#### **âœ… å½“å‰å®ç°çš„ä¼˜åŠ¿**
1. **æ™ºèƒ½ç¯å¢ƒæ£€æµ‹** - å¼€å‘ç¯å¢ƒä¿æŒå¯è¯»æ€§ï¼Œç”Ÿäº§ç¯å¢ƒè‡ªåŠ¨ä¼˜åŒ–
2. **å®Œæ•´çš„ä¼˜åŒ–é“¾** - å‹ç¼© â†’ æŒ‡çº¹ â†’ å®Œæ•´æ€§æ£€æŸ¥
3. **åˆ†ç¦»åŠ è½½ç­–ç•¥** - ä¸»é¢˜ CSS å’Œè¯­æ³•é«˜äº® CSS åˆ†ç¦»ï¼ŒæŒ‰éœ€åŠ è½½
4. **ç¼“å­˜å‹å¥½** - æ–‡ä»¶æŒ‡çº¹ç¡®ä¿å®Œç¾çš„ç¼“å­˜ç­–ç•¥

#### **ğŸ¯ æ€§èƒ½æŒ‡æ ‡**
- **CSS å‹ç¼©ç‡**: 99.7% (339 è¡Œ â†’ 1 è¡Œ)
- **æ–‡ä»¶å¤§å°**: ~15KB â†’ ~3KB â†’ ~1KB (Gzip)
- **ç¼“å­˜ç­–ç•¥**: é•¿æœŸç¼“å­˜ + å†…å®¹å“ˆå¸Œ
- **å®‰å…¨æ€§**: SRI å®Œæ•´æ€§æ£€æŸ¥

#### **ğŸš€ éƒ¨ç½²å»ºè®®**
1. **ä¿æŒå½“å‰é…ç½®** - æ— éœ€é¢å¤–é…ç½®ï¼Œå·²ç»æ˜¯æœ€ä½³å®è·µ
2. **ç›‘æ§æ€§èƒ½** - å®šæœŸä½¿ç”¨æ€§èƒ½æµ‹è¯•å·¥å…·æ£€æŸ¥
3. **ç‰ˆæœ¬æ§åˆ¶** - ç¡®ä¿ `public/` ç›®å½•ä¸è¢«æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
4. **CDN é…ç½®** - Vercel è‡ªåŠ¨å¤„ç†ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®

## æ€»ç»“

**å½“å‰çš„ CSS å¤„ç†æ–¹å¼å·²ç»éå¸¸ä¼˜ç§€ï¼** 

âœ… **ç”Ÿäº§ç¯å¢ƒè‡ªåŠ¨å‹ç¼©** - è¯­æ³•é«˜äº® CSS å‹ç¼©ç‡è¾¾ 99.7%  
âœ… **æ™ºèƒ½ç¼“å­˜ç­–ç•¥** - æ–‡ä»¶æŒ‡çº¹ + é•¿æœŸç¼“å­˜  
âœ… **å®‰å…¨æ€§ä¿éšœ** - SRI å®Œæ•´æ€§æ£€æŸ¥  
âœ… **å¹³å°ä¼˜åŒ–** - Vercel é¢å¤–çš„ Gzip/Brotli å‹ç¼©  
âœ… **å…¨çƒåˆ†å‘** - CDN åŠ é€Ÿè®¿é—®  

æ— éœ€é¢å¤–é…ç½®ï¼Œå½“å‰å®ç°å·²ç»éµå¾ªäº†æ‰€æœ‰ Web æ€§èƒ½æœ€ä½³å®è·µï¼ğŸ‰
